{% extends 'competition_index.html' %}

{% block scripts %}
<script src="{{ STATIC_URL }}js/mootools-core-1.3.js"></script>
<script src="{{ STATIC_URL }}js/competition_entries.js"></script>
<script>
    window.addEvent('domready', function () {
        var archer, club, bowstyle, gender;
        var reset = function () {
            club.reset();
            bowstyle.reset();
            gender.reset();
            $$('.show-more-details').removeClass('selected');
            $$('.more-details').removeClass('shown');
        }
        archer = new SelectWidget({
            widget: $('archer-widget'),
            blank: 'New Archer',
            callback: function (widget) {
                reset();
                $$('.archer-details').addClass('shown');
                if (widget.is_new) {
                    $$('.show-more-details').fireEvent('click');
                } else {
                    club.setValue(widget.selectedObject.club);
                    bowstyle.widget.getElement('[rel=' + widget.selectedObject.bowstyle + ']').fireEvent('click');
                    gender.widget.getElement('[rel=' + widget.selectedObject.gender + ']').fireEvent('click');
                }
            }
        });
        club = new SelectWidget({
            widget: $('club-widget'),
            blank: 'New Club'
        });
        bowstyle = new ButtonWidget($('bowstyle-widget'));
        gender = new ButtonWidget($('gender-widget'));
        $$('.show-more-details').addEvent('click', function () {
            $$('.more-details').toggleClass('shown');
            this.toggleClass('selected');
        });
    });
</script>
{% endblock %}

{% block competition_content %}
<!--p>
What should this page look like? We need to be able to do the following: Add new entries, modify existing entries (including make a note of payments), see all of the sessions and which round the archer has entered in which session, filter and/or search the entries, see stats on how many entries you have.
</p>
<p>
Adding new entries will probably be the biggest use case for the page, so this should appear at the top. There should be a single large input box, which acts as a select box as before. Once you have selected an archer, the options should appear and be easily changeable.
</p>
<p>
Should you be able to add multiple entrants in one go? Should we do AJAX saving?
</p-->
<div class="competition-entries">
    <div class="top">
        <div class="new-entry">
            <h4>New Entry</h4>
            <div class="new-entry-form">
                <div class="hidden">
                    {{ form.age }}
                    {{ form.novice }}
                </div>
                <div class="select-widget" id="archer-widget">
                    <div class="select">
                        {{ form.archer }}
                    </div>
                    {{ form.archer_name }}
                    <div class="options-wrapper">
                        <ul class="options"></ul>
                    </div>
                </div>
                <div class="archer-details">
                    <div class="select-widget" id="club-widget">
                        <div class="select">
                            {{ form.club }}
                        </div>
                        {{ form.club_name }}
                        <div class="options-wrapper">
                            <ul class="options"></ul>
                        </div>
                    </div>
                    <div class="buttons-widget" id="bowstyle-widget">
                        <div class="select">
                            {{ form.bowstyle }}
                        </div>
                        {% for choice in form.fields.bowstyle.choices %}
                        {% if choice.0 %}
                        <div class="button" rel="{{ choice.0 }}">
                            {{ choice.1 }}
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    <div class="show-more-details button">
                        More options <div class="pointer">&raquo;</div>
                    </div>
                    <div class="button" id="save">
                        Save
                    </div>
                    <div class="clear"></div>
                    <div class="more-details">
                        <div class="buttons-widget" id="gender-widget">
                            <div class="select">
                                {{ form.gender }}
                            </div>
                            {% for choice in form.fields.gender.choices %}
                            {% if choice.0 %}
                            <div class="button" rel="{{ choice.0 }}">
                                {{ choice.1 }}
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="stats">
            <h4>Entries Summary</h4>
            <ul>
                <li>Current total entries: 24</li>
                <li>Current total entries: 24</li>
                <li>Current total entries: 24</li>
                <li>Current total entries: 24</li>
                <li>Current total entries: 24</li>
                <li>Current total entries: 24</li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
    <div class="entries-table">
        <table>
            <caption><h4>Existing entries</h4></caption>
            <thead>
                <th>Name</th>
                <th>Club</th>
                <th>Bowstyle</th>
                <th>Gender</th>
                <th>Age</th>
                <th>06/08/11</th>
                <th>07/08/11</th>
            </thead>
            <tr>
                <td>Marc Tamlyn</td>
                <td></td>
                <td>Recurve</td>
                <td>Male</td>
                <td>Senior</td>
                <td>FITA 70m</td>
                <td>Gents FITA</td>
                <td>Edit</td>
            </tr>
        </table>
    </div>
</div>
{% endblock %}
