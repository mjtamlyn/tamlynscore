{% extends 'target_list.html' %}

{% block scripts %}
<script src="{{ STATIC_URL }}js/mootools-core-1.3.js"></script>
<script>
    window.addEvent('domready', function () {
        $$('.session-select a').addEvent('click', function (e) {
            if (e) { e.stop(); }
            // do this row
            $$('.session-select .link').removeClass('selected');
            this.getElement('.link').addClass('selected');
            // do the round select row
            $$('.round-select').removeClass('selected');
            var newRoundSelect = $$(this.get('href'));
            newRoundSelect.addClass('selected');
            newRoundSelect.getElement('.selected').getParent('a').fireEvent('click');
        });

        $$('.round-select a').addEvent('click', function (e) {
            if (e) { e.stop(); }
            // do this row
            this.getParent('.round-select').getElements('.link').removeClass('selected');
            this.getElement('.link').addClass('selected');
            // do the generator
            target = this.get('href');
            var board = $$(target);
            document.location.hash = target.replace('#', '#!');
            $$('.board').removeClass('selected');
            board.addClass('selected');
        });

        if (document.location.hash) {
            $$('a[href=' + document.location.hash.replace('#!', '#') + ']').fireEvent('click');
            $$('a[href=' + document.location.hash.replace('#!', '#').replace(/-round-\d/, '') + ']').fireEvent('click');
        }
    });
</script>
{% endblock scripts %}

{% block moduleclass %}leaderboard{% endblock %}
{% block title %}{{ title }}{% endblock %}

{% block main %}
<div class="board selected">
    <table>
        {% for category, scores in results %}
        <tr>
            <td colspan="100%"><h5>{{ category }}</h5></td>
        </tr>
        {% for score in scores %}
        <tr>
            {% if score.disqualified %}
            <td></td>
            {% else %}
            <td>{{ forloop.counter }}</td>
            {% endif %}
            <td>{{ score.target.session_entry.competition_entry.archer }}</td>
            <td>{{ score.target.session_entry.competition_entry.club}}</td>
            {% if score.disqualified %}
            <td>DSQ</td>
            <td></td>
            <td></td>
            <td></td>
            {% else %}
            <td>{{ score.score }}</td>
            <td>{{ score.hits }}</td>
            <td>{{ score.golds }}</td>
            <td>{{ score.xs }}</td>
            {% endif %}
        </tr>
        {% endfor %}
    {% endfor %}
    </table>
</div>
{% endblock %}
