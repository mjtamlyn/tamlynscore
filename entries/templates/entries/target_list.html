{% extends 'entries/competition_detail.html' %}

{% block extrastyles %}
<link rel="stylesheet" href="{{ STATIC_URL }}css/eggplant/autocomplete.css" />
{% endblock %}

{% block scripts %}
<script src="{{ STATIC_URL }}js/jquery-1.7.2.min.js"></script>
<script src="{{ STATIC_URL }}js/jquery-autocomplete.js"></script>
<script src="{{ STATIC_URL }}js/target_list.js"></script>
{% endblock scripts %}

{% block competition_content %}
<div class="{% block moduleclass %}target-list{% endblock %} module">
    <h4>{% block title %}Target Lists{% endblock %}</h4>

    {% block main %}
    {% for session, details in target_list.items %}
    <div class="session" data-archers="{{ details.entries_json }}">
        <h5>{{ session }}</h5>
        <p>Round{{ details.rounds|pluralize }}: {% for round in details.rounds %}{{ round.shot_round }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
        {% for boss, entries in details.target_list %}
            <div class="boss" data-boss="{{ boss }}">
                <span class="boss_number">{{ boss }}</span>
                <ul>
                    {% for detail, entry in entries %}
                    <li>
                        <span class="detail">{{ detail }}:</span>
                        {% if entry %}
                            <span class="archer">{{ entry.session_entry.competition_entry.archer }}</span> <a class="delete" data-location="{{ boss }}{{ detail }}" data-pk="{{ entry.pk }}" data-entry-pk="{{ entry.session_entry.pk }}">X</a>
                        {% else %}
                            <input data-location="{{ boss }}{{ detail }}">
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
        <ul class="unallocated">
            {% for entry in details.entries %}
            <li data-pk="{{ entry.pk }}">{{ entry.competition_entry.archer }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endfor %}
    {% endblock %}
</div>
{% endblock %}
